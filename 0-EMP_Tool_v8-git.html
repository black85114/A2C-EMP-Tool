<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECADæ¨¡å‹å‚™ä»½æ›¿æ›å·¥å…· v0.8</title>
    <script src="./creojs.js"></script>
	<link rel="stylesheet" type="text/css" href="./style.css">
	<script type="text/creojs">
		// === åŸæœ‰çš„ Creo.JS å‡½æ•¸ (ä¿æŒä¸è®Š) ===
		function getSession() {
			return pfcGetCurrentSession();
		}
		
		function getCurrentModelName() {
			try {
				const session = getSession();
				const model = session.CurrentModel;
				if (model) {
					let fileName = model.FileName;
					if (fileName.includes(".")) {
						fileName = fileName.substring(0, fileName.lastIndexOf("."));
					}
					return fileName;
				} else {
					return null;
				}
			} catch (error) {
				return null;
			}
		}
		
		function getCurrentDirectory() {
			try {
				const session = getSession();
				return session.GetCurrentDirectory();
			} catch (error) {
				return null;
			}
		}
		
		function findBackupDirectory() {
			try {
				const session = getSession();
				const model = session.CurrentModel;
				const currentDir = model.Origin;
				const lastSlashIndex = Math.max(currentDir.lastIndexOf("\\"), currentDir.lastIndexOf("/"));
				const modelPath = currentDir.substring(0, lastSlashIndex);    
				return modelPath;
			} catch (error) {
				return null;
			}
		}
		
		function setWorkingDirectory(fullPath) {
			try {
				const session = getSession();
				session.ChangeDirectory(fullPath);
				return session.GetCurrentDirectory();
			} catch (error) {
				return { error: error.message };
			}
		}
		
		function runColorMacro() {
			try {
				const session = getSession();
				const macro_paint = "~ Select `main_dlg_cur` `PHTLeft.AssyTree` 1 `T2 7`;" +
									"~ Command `ProCmdMakeActive@PopupMenuTree`;" +
									"~ Command `ProCmdMdlTreeSearch`;" +                              
									"~ Open `selspecdlg0` `SelOptionRadio`" +
									"~ Close `selspecdlg0` `SelOptionRadio`;" +
									"~ Select `selspecdlg0` `SelOptionRadio` 1 `Geometric Body`;" +
									"~ Open `selspecdlg0` `ExtRulesLayout.ExtBasicNameLayout.BasNameComp`;" +
									"~ Close `selspecdlg0` `ExtRulesLayout.ExtBasicNameLayout.BasNameComp`;" +
									"~ Select `selspecdlg0` `ExtRulesLayout.ExtBasicNameLayout.BasNameComp` 1 ` != `;" +
									"~ Update `selspecdlg0` `ExtRulesLayout.ExtBasicNameLayout.BasicNameList` `*`;" +
									"~ Activate `selspecdlg0` `EvaluateBtn`;" +
									"~ Activate `selspecdlg0` `ApplyBtn`;" +            
									"~ Activate `selspecdlg0` `CancelButton`;" +
									"~ Activate `main_dlg_cur` `page_View_control_btn` 1;" +
									"~ Select `main_dlg_cur` `View:ProCmdViewGallery`;" +
									"~ Select `main_dlg_cur` `ProCmdViewGallery_layoutph.palette_holder.myAppPalette.NamesList` 1 `ptc-metallic-blue`;" +
									"~ Timer `` `` `Gallery_UI_Timer`;" +
									"~ Close `main_dlg_cur` `View:ProCmdViewGallery`;" +
									"~ Select `main_dlg_cur` `PHTLeft.AssyTree` 1 `node0`;" +
									"~ Command `ProCmdMakeActive@PopupMenuTree` ;" +
									"~ Close `main_dlg_cur` `Model:ProCmdViewGallery`;"+
									"~ LButtonArm `main_dlg_cur` `proe_win` 9 765 717 0 1 1461 815 1920 1080 1709707;" +
									"~ LButtonDisarm `main_dlg_cur` `proe_win` 9 765 717 0 0 1461 815 1920 1080 1709794;";
				
				session.RunMacro(macro_paint);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}
		
		function checkColoringStatus() {
			try {
				const session = getSession();
				const model = session.CurrentModel;
				
				if (model) {
					return model.IsActive();
				}
				return false;
			} catch (error) {
				return false;
			}
		}
		
		function runDelMacro() {
			try {
				const session = getSession();
				const macro_del = 	"~ Command `ProCmdMdlTreeSearch` ;"+
									"~ Open `selspecdlg0` `SelOptionRadio`;"+
									"~ Close `selspecdlg0` `SelOptionRadio`;"+
									"~ Select `selspecdlg0` `SelOptionRadio` 1 `Part`;"+
									"~ Select `selspecdlg0` `CascadeButton1`;"+
									"~ Close `selspecdlg0` `CascadeButton1`;"+
									"~ Activate `selspecdlg0` `CondBuilderCheck` 1;"+
									"~ Update `selspecdlg0` `ExtRulesLayout.ExtBasicNameLayout.BasicNameList` `H*`;"+
									"~ Activate `selspecdlg0` `AddRuleBtn`;"+
									"~ Update `selspecdlg0` `ExtRulesLayout.ExtBasicNameLayout.BasicNameList` `TEST*`;"+
									"~ Activate `selspecdlg0` `AddRuleBtn`;"+
									"~ Update `selspecdlg0` `ExtRulesLayout.ExtBasicNameLayout.BasicNameList` `SH*`;"+
									"~ Activate `selspecdlg0` `AddRuleBtn`;"+
									"~ Update `selspecdlg0` `ExtRulesLayout.ExtBasicNameLayout.BasicNameList` `K*`;"+
									"~ Activate `selspecdlg0` `AddRuleBtn`;"+
									"~ Activate `selspecdlg0` `EvaluateBtn`;"+
									"~ Select `selspecdlg0` `ResultList` -1;;"+
									"~ Activate `selspecdlg0` `ApplyBtn`;"+
									"~ Activate `selspecdlg0` `CancelButton`;"+
									"~ Command `ProCmdEditDelete` ;"+
									"~ Activate `del_sup_msg` `ok`;";
				session.RunMacro(macro_del);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}	
		
		function runBackupMacro(folderName) {
			try {
				const session = getSession();
				const macro_backup = "~ Command `ProCmdModelBackup` ;" +
									 "~ RButtonArm `file_saveas` `ph_list.Filelist` ``;" +                                     
									 "~ PopupOver `file_saveas` `listPopup` 1 `ph_list.Filelist`;" +                           
									 "~ Open `file_saveas` `listPopup`;" +
									 "~ Close `file_saveas` `listPopup`;" +
									 "~ Activate `file_saveas` `newdirectory_pb0`;" +
									 "~ Update `getnewdir` `new_dir_input` `" + folderName + "`;" +
									 "~ Activate `getnewdir` `OK_button`;" +
									 "~ Activate `file_saveas` `OK`;"+
									 "~ Close `unembedded_browser_dialog` `unembedded_browser_dialog`";
				
				session.RunMacro(macro_backup);
				return folderName;
			} catch (error) {
				return { error: error.message };
			}
		}
		
		function checkBackupStatus(folderName) {
			try {
				const session = getSession();
				const files = session.ListFiles("*", true);
				
				for (let i = 0; i < files.Count; i++) {
					const fileEntry = files.Item(i);
					if (fileEntry.toUpperCase().endsWith(folderName.toUpperCase())) {
						 return true;
					}
				}
				return false;
			} catch (error) {
				return false;
			}
		}
		
		function runCleanMacro() {
			try {
				const session = getSession();
				const macro_clean = 
									"~ Command `ProCmdWinCloseGroup` ;" +
									"~ Command `ProCmdModelEraseNotDisp` ;" +    
									"~ Activate `file_erase_nd` `ok_pb`;"+
									"~ Command `ProCmdBrowserBtn`  1;";
				
				session.RunMacro(macro_clean);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}
		
		function runBatchMacro() {
			try {
				const session = getSession();
				const macro_bat =  "@SYSTEM xcopy \"\\\\\\\\10.1.182.31\\\\a2\\\\A2C\\\\Temp\\\\WEB\\\\000-EMP_Translator_v8.ps1\" \"\%cd\%\" /Y  \\n "+
									"start cmd /c powershell.exe -ExecutionPolicy Bypass -File  \".\\\\000-EMP_Translator_v8.ps1\"\\n exit;" ;
				
				session.RunMacro(macro_bat);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}
		
		function checkCleanStatus() {
			try {
				const session = getSession();
				const models = session.ListModels();
				return models.Count <= 1;
			} catch (error) {
				return false;
			}
		}
		
		function runOpenAsmMacro(folderName) {
			try {
				const session = getSession();
				const asmFileName = `0-${folderName}.asm`;
				
				const macro_open_asm = 	"~ Activate `main_dlg_cur` `EMBED_BROWSER Close` ;"+
										"~ Command `ProCmdModelOpen` ;"+
										"~ Select `file_open` `Ph_list.Filelist` 1 `'${asmFileName}'` ;"+
										"~ Activate `file_open` `Ph_list.Filelist` 1 `'${asmFileName}'` ;"+
										"~ Activate `open_rep` `OpenCascBtn`;";                                                     
										
				session.RunMacro(macro_open_asm);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}
		
		// === æ–°å¢çš„é…ç½®ç®¡ç†å‡½æ•¸ ===
		function updateConfigFile(configData) {
			try {
				const session = getSession();
				
				// æ§‹å»ºå®Œæ•´çš„é…ç½®å…§å®¹
				const configLines = [
					"FtpLibEnabled=" + configData.ftpLibEnabled,
					"LocalLibEnabled=" + configData.localLibEnabled,
					"CopyMatchingSourceFolders=" + configData.copyMatchingSourceFolders,
					"AutoZeroRenameEnabled=" + configData.autoZeroRenameEnabled,
					"SelfDestructEnabled=" + configData.selfDestructEnabled,
					"NasHostName=" + configData.nasHostName,
					"StatusIP=" + configData.statusIP,
					"LocalLibAddr=" + configData.localLibAddr
				];
				
				// æ§‹å»º Batch æŒ‡ä»¤
				let batchCommand = "@SYSTEM cmd /c ";
				
				// åˆªé™¤èˆŠæª”æ¡ˆ
				batchCommand += "del D:\\\\\\EMP-Config.ini\\n";
				
				// é€è¡Œå¯«å…¥æª”æ¡ˆ
				for (let i = 0; i < configLines.length; i++) {
					const line = configLines[i];
					if (i === 0) {
						batchCommand += "echo "+ line + " >> D:\\\\\\EMP-Config.ini\\n";
					} else {
						batchCommand += "echo " + line + " >> D:\\\\\\EMP-Config.ini\\n";
					}
				}
								
				session.RunMacro(batchCommand);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}
		
		// æ–°å¢ï¼šåŸ·è¡Œé–‹å•Ÿ ASM å·¨é›†
		function runOpenAsmMacro(folderName) {
			try {
				const session = getSession();
				const asmFileName = `0-${folderName}.asm`; // Construct the filename like '0-MODELNAME.asm'
				
				// Note the single quotes around the filename in the macro, as per your example
				const macro_open_asm = 	"~ Activate `main_dlg_cur` `EMBED_BROWSER Close` ;"+
										"~ Command `ProCmdModelOpen` ;"+
										"~ Select `file_open` `Ph_list.Filelist` 1 `'${asmFileName}'` ;"+
										"~ Activate `file_open` `Ph_list.Filelist` 1 `'${asmFileName}'` ;"+
										"~ Activate `open_rep` `OpenCascBtn`;";                                                     
										
				session.RunMacro(macro_open_asm);
				return true; // Indicate success
			} catch (error) {
				return { error: error.message };
			}
		}	
		
		 // === ä¸€éµéƒ¨ç½²å‡½æ•¸ (ä¿æŒåŸæœ‰ macro ä»£ç¢¼) ===
		function deployMapkey() {
			try {
				const session = getSession();
				const macro_mapkey = "~ Command `ProCmdUtilMacros`;"+ 
									"~ Select `mapkey_main` `ImpExpCascButton`;"+
									"~ Close `mapkey_main` `ImpExpCascButton`;"+
									"~ Activate `mapkey_main` `psh_import`;"+
									"~ Input `file_open` `opt_EMBED_BROWSER_TB_SAB_LAYOUT` `\\\\\\\\10.1.182.31\\\\a2\\\\A2C\\\\Temp\\\\WEB`;"+
									"~ Update `file_open` `opt_EMBED_BROWSER_TB_SAB_LAYOUT` `\\\\\\\\10.1.182.31\\\\a2\\\\A2C\\\\Temp\\\\WEB`;"+
									"~ Activate `file_open` `opt_EMBED_BROWSER_TB_SAB_LAYOUT`;"+
									"~ FocusIn `file_open` `EMBED_BROWSER_SEARCH_IP`;"+
									"~ FocusOut `file_open` `EMBED_BROWSER_SEARCH_IP`;"+
									"~ Select `file_open` `Ph_list.Filelist` 1 `mapkeys.pro`;"+
									"~ Activate `file_open` `Ph_list.Filelist` 1 `mapkeys.pro`;"+
									"~ Select `mapkey_main` `SaveCascBtn`;"+
									"~ Close `mapkey_main` `SaveCascBtn`;"+
									"~ Activate `mapkey_main` `psh_save_changed`;"+
									"~ Activate `mapkey_main` `CloseButton`;"; 
				
				session.RunMacro(macro_mapkey);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}
		
		function deployRibbon() {
			try {
				const session = getSession();
				const macro_ribbon = "~ Command `AdbCmdOptCustDlg` ;"+
									"~ Open `ribbon_options_dialog` `RibbonCustMenuLayout.RibbonTreeLay.CustRbnModeOptionMenu`;"+
									"~ Close `ribbon_options_dialog` `RibbonCustMenuLayout.RibbonTreeLay.CustRbnModeOptionMenu`;"+
									"~ Select `ribbon_options_dialog` `RibbonCustMenuLayout.RibbonTreeLay.CustRbnModeOptionMenu` 1 `CustRbnPopularModes`;"+
									"~ FocusIn `ribbon_options_dialog` `RibbonCustMenuLayout.RibbonTreeLay.RibbonTree`;"+
									"~ FocusOut `ribbon_options_dialog` `RibbonCustMenuLayout.RibbonTreeLay.RibbonTree`;"+
									"~ Activate `ribbon_options_dialog` `RibbonCustMenuLayout.ImportPB`;"+
									"~ Input `file_open` `opt_EMBED_BROWSER_TB_SAB_LAYOUT` `\\\\\\\\10.1.182.31\\\\a2\\\\A2C\\\\Temp\\\\WEB`;"+
									"~ Update `file_open` `opt_EMBED_BROWSER_TB_SAB_LAYOUT` `\\\\\\\\10.1.182.31\\\\a2\\\\A2C\\\\Temp\\\\WEB`;"+
									"~ Activate `file_open` `opt_EMBED_BROWSER_TB_SAB_LAYOUT`;"+
									"~ FocusIn `file_open` `EMBED_BROWSER_SEARCH_IP`;"+
									"~ FocusOut `file_open` `EMBED_BROWSER_SEARCH_IP`;"+
									"~ Select `file_open` `Ph_list.Filelist` 1 `creo_emp.ui`;"+
									"~ Activate `file_open` `Ph_list.Filelist` 1 `creo_emp.ui`;"+
									"~ Activate `RibbonCustImport` `import`;"+
									"~ Activate `ribbon_options_dialog` `OkPshBtn`;";
				
				session.RunMacro(macro_ribbon);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}
		function deployPowerShellValidation() {
			try {
				const session = getSession();
				const macro_ps_validation = "@SYSTEM xcopy \"\\\\\\\\10.1.182.31\\\\a2\\\\A2C\\\\Temp\\\\WEB\\\\Set-PowerShell-Policy.bat\" \"\%cd\%\" /Y  \\n "+
											"start cmd /c  \".\\\\Set-PowerShell-Policy.bat\"\\n exit;" ;
				
				session.RunMacro(macro_ps_validation);
				return true;
			} catch (error) {
				return { error: error.message };
			}
		}
	</script>
</head>
<body>
<div class="container">
    <img src="https://embedded.avnet.com/wp-content/uploads/2022/09/gigaipc_logo.png" alt="gigaipc logo" height="33" width="150" style="text-align: center;">
    <h1>EMN/EMP æ¨¡å‹å‚™ä»½æ›¿æ›å·¥å…· v0.8</h1>
    
    <!-- Tab é¸å–® -->
    <div class="tab-container">
        <div class="tab-buttons">
            <button class="tab-button active" onclick="switchTab('main-tab')">EMP Translator</button>
            <button class="tab-button" onclick="switchTab('deploy-tab')">åˆæ¬¡ä½¿ç”¨éƒ¨å±¬</button>
        </div>
        
        <!-- ä¸»è¦åŠŸèƒ½ Tab -->
        <div id="main-tab" class="tab-content active">
            <!-- åˆ‡æ›é…ç½®é¡¯ç¤ºæŒ‰éˆ• -->
            <button class="toggle-config-btn" id="toggleConfigBtn" onclick="toggleConfigSection()">é…ç½®è¨­å®š</button>
            
            <!-- EMP æ›¿æ›å·¥å…·é…ç½®è¨­å®šå€å¡Š -->
            <div class="config-section" id="configSection">
                <h3>EMP æ›¿æ›å·¥å…·é…ç½®è¨­å®š</h3>
                
                <div class="config-row">
                    <div class="config-item">
                        <div class="switch-label">
                            <label class="switch">
                                <input type="checkbox" id="ftpLibEnabled" checked>
                                <span class="slider"></span>
                            </label>
                            <span>FTP Library åŠŸèƒ½</span>
                        </div>
                    </div>
                    <div class="config-item">
                        <div class="switch-label">
                            <label class="switch">
                                <input type="checkbox" id="localLibEnabled" checked>
                                <span class="slider"></span>
                            </label>
                            <span>æœ¬åœ° Library åŠŸèƒ½</span>
                        </div>
                    </div>
                </div>
                
                <div class="config-row">
                    <div class="config-item">
                        <div class="switch-label">
                            <label class="switch">
                                <input type="checkbox" id="copyMatchingSourceFolders">
                                <span class="slider"></span>
                            </label>
                            <span>ä¾†æºè³‡æ–™å¤¾è¤‡è£½</span>
                        </div>
                    </div>
                    <div class="config-item">
                        <div class="switch-label">
                            <label class="switch">
                                <input type="checkbox" id="autoZeroRenameEnabled" checked>
                                <span class="slider"></span>
                            </label>
                            <span>.asm è‡ªå‹•é‡æ–°å‘½å</span>
                        </div>
                    </div>
                </div>
                
                <div class="config-row">
                    <div class="config-item">
                        <div class="switch-label">
                            <label class="switch">
                                <input type="checkbox" id="selfDestructEnabled" checked>
                                <span class="slider"></span>
                            </label>
                            <span>è…³æœ¬è‡ªå‹•åˆªé™¤</span>
                        </div>
                    </div>
                </div>
                
                <div class="config-row">
                    <div class="config-item">
                        <label for="statusIP">å‚™ç”¨ IP ä½å€:</label>
                        <input type="text" id="statusIP" value="10.1.182.31">
                       
                    </div>
                    <div class="config-item">
                        <label for="nasHostName">NAS ä¸»æ©Ÿåç¨±:</label>
                        <input type="text" id="nasHostName" value="ipcfile.gigaipc.intra">
                        
                    </div>
                </div>
                
                <div class="config-row">
                    <div class="config-item">
                        <label for="localLibAddr">æœ¬åœ° Library è·¯å¾‘:</label>
                        <input type="text" id="localLibAddr" value="D:\GIGAIPC_3D\Wayne_LIB" >
                        
                    </div>
                </div>
                
                <button class="save-config-btn" id="saveConfigBtn">å„²å­˜é…ç½®</button><span style="font-size:12px;color:gray;">é…ç½®æª” EMP-Config.ini å„²å­˜è‡³D:/</span>
            </div>
            
            <div id="currentModelInfo" class="current-model">
                æ­£åœ¨è¼‰å…¥æ¨¡å‹è³‡è¨Š...
            </div>
            
            <div id="directoryInfo" class="directory-info">
                æ­£åœ¨è¼‰å…¥ç›®éŒ„è³‡è¨Š...
            </div>

            <div class="checkbox-options">
                <div class="form-group checkbox-item">
                    <label class="switch">
                        <input type="checkbox" id="runDelMacroCheckbox" checked>
                        <span class="slider"></span>
                    </label>
                    <label for="runDelMacroCheckbox">åˆªé™¤å®šä½é›¶ä»¶ (é è¨­)</label>
                </div>
                <div class="form-group checkbox-item">
                    <label class="switch">
                        <input type="checkbox" id="runColorMacroCheckbox" checked>
                        <span class="slider"></span>
                    </label>
                    <label for="runColorMacroCheckbox">PCBæ¿è‘—è‰² (é‡‘å±¬è—)</label>
                </div>
            </div>
                    
            <div class="form-group"> 
                <button id="useCurrentModelBtn">åŸ·è¡Œæ¨¡å‹å‚™ä»½+æ›¿æ›EMP</button>
            </div>

            <div class="status" id="status">
                <div class="status-message">æº–å‚™å°±ç·’ï¼Œè«‹é¸æ“‡æ“ä½œã€‚</div>
            </div>
        </div>
        
        <!-- ä¸€éµéƒ¨ç½² Tab -->
        <div id="deploy-tab" class="tab-content">
            <div class="config-section" style="display: block;">
                <h3>ä¸€éµéƒ¨ç½²Creo Tool</h3>
                <p>æ­¤åŠŸèƒ½å°‡ä¾åºåŸ·è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
                <ol>
                    <li><strong>Import Mapkey.pro</strong> - åŒ¯å…¥ Creo å¿«æ·éµè¨­å®š</li>
                    <li><strong>Import Ribbonè¨­å®šæª”</strong> - åŒ¯å…¥åŠŸèƒ½åˆ—é…ç½®</li>
                    <li><strong>PowerShell é©—è­‰Batchæª”</strong> - åŸ·è¡Œé©—è­‰ç¨‹åº</li>
                </ol>
                
                <button class="deploy-btn" id="deployCreoToolBtn">ğŸš€ ä¸€éµéƒ¨ç½²Creo Tool (ç¬¬ä¸€æ¬¡ä½¿ç”¨)</button>
            </div>
            
            <div class="status" id="deployStatus">
                <div class="status-message">æº–å‚™åŸ·è¡Œéƒ¨ç½²æ“ä½œã€‚</div>
            </div>
        </div>
    </div>
</div>
<scrip>
	// Tab åˆ‡æ›åŠŸèƒ½
	function switchTab(tabId) {
	    // éš±è—æ‰€æœ‰ tab content
	    const tabContents = document.querySelectorAll('.tab-content');
	    tabContents.forEach(content => content.classList.remove('active'));
	    
	    // ç§»é™¤æ‰€æœ‰ tab button çš„ active ç‹€æ…‹
	    const tabButtons = document.querySelectorAll('.tab-button');
	    tabButtons.forEach(button => button.classList.remove('active'));
	    
	    // é¡¯ç¤ºé¸ä¸­çš„ tab content
	    document.getElementById(tabId).classList.add('active');
	    
	    // è¨­å®šå°æ‡‰çš„ tab button ç‚º active
	    event.target.classList.add('active');
	}
	
	// åˆ‡æ›é…ç½®å€å¡Šé¡¯ç¤º/éš±è—
	function toggleConfigSection() {
	    const configSection = document.getElementById('configSection');
	    const toggleBtn = document.getElementById('toggleConfigBtn');
	    
	    if (configSection.classList.contains('active')) {
	        configSection.classList.remove('active');
	        toggleBtn.textContent = 'ğŸ”§ é¡¯ç¤º EMP é…ç½®è¨­å®š';
	    } else {
	        configSection.classList.add('active');
	        toggleBtn.textContent = 'ğŸ”§ éš±è— EMP é…ç½®è¨­å®š';
	    }
	}
	// åˆå§‹åŒ–é é¢
	document.addEventListener('DOMContentLoaded', function() {
	    const button = document.getElementById('useCurrentModelBtn');
	    const runDelMacroCheckbox = document.getElementById('runDelMacroCheckbox');
	    const runColorMacroCheckbox = document.getElementById('runColorMacroCheckbox');
	    const saveConfigBtn = document.getElementById('saveConfigBtn');
	    const deployCreoToolBtn = document.getElementById('deployCreoToolBtn');
		
		// è¨­ç½® Creo.JS åˆå§‹åŒ–å®Œæˆå¾Œçš„å›èª¿
		CreoJS.$ADD_ON_LOAD(function() {
			updateCurrentModelInfo();
			updateDirectoryInfo();
		});
		
		// å„²å­˜é…ç½®æŒ‰éˆ•äº‹ä»¶
		saveConfigBtn.addEventListener('click', async function() {
			try {
				saveConfigBtn.disabled = true;
				addStatusMessage("æ­£åœ¨å„²å­˜é…ç½®...", "info");
				
				// æ”¶é›†é…ç½®è³‡æ–™
				const configData = {
					ftpLibEnabled: document.getElementById('ftpLibEnabled').checked,
					localLibEnabled: document.getElementById('localLibEnabled').checked,
					copyMatchingSourceFolders: document.getElementById('copyMatchingSourceFolders').checked,
					autoZeroRenameEnabled: document.getElementById('autoZeroRenameEnabled').checked,
					selfDestructEnabled: document.getElementById('selfDestructEnabled').checked,
					nasHostName: document.getElementById('nasHostName').value || 'ipcfile.gigaipc.intra',
					statusIP: document.getElementById('statusIP').value || '10.1.182.31',
					localLibAddr: document.getElementById('localLibAddr').value.replace(/\\/g, '\\\\') || 'D:\\GIGAIPC_3D\\Wayne_LIB'
				};
				
				// å‘¼å« Creo.JS å‡½æ•¸æ›´æ–°é…ç½®æª”æ¡ˆ
				const result = await  CreoJS.updateConfigFile(configData);
				
				if (result && !result.error) {
					addStatusMessage("âœ… é…ç½®å·²æˆåŠŸå„²å­˜åˆ° D:\\Config.ini", "success");
				} else {
					addStatusMessage("âŒ é…ç½®å„²å­˜å¤±æ•—: " + (result?.error || "æœªçŸ¥éŒ¯èª¤"), "error");
				}
				
			} catch (error) {
				addStatusMessage("âŒ é…ç½®å„²å­˜æ™‚ç™¼ç”ŸéŒ¯èª¤: " + error.message, "error");
			} finally {
				saveConfigBtn.disabled = false;
			}
		});
		
		// ä¸€éµéƒ¨ç½²æŒ‰éˆ•äº‹ä»¶
		deployCreoToolBtn.addEventListener('click', async function() {
			try {
				deployCreoToolBtn.disabled = true;
				deployCreoToolBtn.innerHTML = '<span>â³</span>éƒ¨ç½²ä¸­...';
				addStatusMessage("ğŸš€ é–‹å§‹åŸ·è¡Œä¸€éµéƒ¨ç½² Creo Tool...", "info");
				
				// æ­¥é©Ÿ1: Import Mapkey.pro
				addStatusMessage("æ­¥é©Ÿ 1/3: æ­£åœ¨åŒ¯å…¥ Mapkey.pro...", "info");
				await sleep(500);
				const mapkeyResult = await CreoJS.deployMapkey();
				if (mapkeyResult && !mapkeyResult.error) {
					addStatusMessage("âœ… Mapkey.pro åŒ¯å…¥æˆåŠŸ", "success");
				} else {
					addStatusMessage("âš ï¸ Mapkey.pro åŒ¯å…¥å¯èƒ½å¤±æ•—: " + (mapkeyResult?.error || "æœªçŸ¥éŒ¯èª¤"), "warning");
				}
				
				// å»¶é²
				await sleep(1500);
				
				// æ­¥é©Ÿ2-1: Import Ribbonè¨­å®šæª”
				addStatusMessage("æ­¥é©Ÿ 2/3: æ­£åœ¨åŒ¯å…¥ Ribbon è¨­å®šæª”...", "info");
				const ribbonResult = await CreoJS.deployRibbon();
				if (ribbonResult && !ribbonResult.error) {
					addStatusMessage("âœ… Ribbon è¨­å®šæª”åŒ¯å…¥æˆåŠŸ", "success");
				} else {
					addStatusMessage("âš ï¸ Ribbon è¨­å®šæª”åŒ¯å…¥å¯èƒ½å¤±æ•—: " + (ribbonResult?.error || "æœªçŸ¥éŒ¯èª¤"), "warning");
				}
				
				// å»¶é²
				await sleep(1500);
				
				// æ­¥é©Ÿ2-2: é å…ˆéƒ¨å±¬å„²å­˜EMP-Config.ini
				addStatusMessage("æ­£åœ¨å„²å­˜é…ç½®...", "info");
				
				// æ”¶é›†é…ç½®è³‡æ–™
				const configData = {
					ftpLibEnabled: document.getElementById('ftpLibEnabled').checked,
					localLibEnabled: document.getElementById('localLibEnabled').checked,
					copyMatchingSourceFolders: document.getElementById('copyMatchingSourceFolders').checked,
					autoZeroRenameEnabled: document.getElementById('autoZeroRenameEnabled').checked,
					selfDestructEnabled: document.getElementById('selfDestructEnabled').checked,
					nasHostName: document.getElementById('nasHostName').value || 'ipcfile.gigaipc.intra',
					statusIP: document.getElementById('statusIP').value || '10.1.182.31',
					localLibAddr: document.getElementById('localLibAddr').value.replace(/\\/g, '\\\\') || 'D:\\GIGAIPC_3D\\Wayne_LIB'
				};
				
				// å‘¼å« Creo.JS å‡½æ•¸æ›´æ–°é…ç½®æª”æ¡ˆ
				const result = await  CreoJS.updateConfigFile(configData);
				
				if (result && !result.error) {
					addStatusMessage("âœ… é…ç½®å·²æˆåŠŸå„²å­˜åˆ° D:\\Config.ini", "success");
				} else {
					addStatusMessage("âŒ é…ç½®å„²å­˜å¤±æ•—: " + (result?.error || "æœªçŸ¥éŒ¯èª¤"), "error");
				}
				
				// å»¶é²
				await sleep(3000);
				
				
				// æ­¥é©Ÿ3: PowerShell é©—è­‰Batchæª”
				addStatusMessage("æ­¥é©Ÿ 3/3: æ­£åœ¨åŸ·è¡Œ PowerShell é©—è­‰...", "info");
				const psResult = await CreoJS.deployPowerShellValidation();
				if (psResult && !psResult.error) {
					addStatusMessage("âœ… PowerShell é©—è­‰åŸ·è¡ŒæˆåŠŸ", "success");
				} else {
					addStatusMessage("âš ï¸ PowerShell é©—è­‰å¯èƒ½å¤±æ•—: " + (psResult?.error || "æœªçŸ¥éŒ¯èª¤"), "warning");
				}
				
				addStatusMessage("ğŸ‰ ä¸€éµéƒ¨ç½² Creo Tool å®Œæˆï¼", "success");
				
			} catch (error) {
				addStatusMessage("âŒ éƒ¨ç½²éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤: " + error.message, "error");
			} finally {
				deployCreoToolBtn.disabled = false;
				deployCreoToolBtn.innerHTML = '<span>ğŸ› ï¸</span>é–‹å§‹éƒ¨ç½² Creo Tool';
			}
		});
		
	Â  Â  Â  Â  Â  // ä½¿ç”¨ç•¶å‰æ¨¡å‹åç¨±æŒ‰éˆ•äº‹ä»¶
	Â  Â  Â  Â  Â  Â  button.addEventListener('click', async function() {
	Â  Â  Â  Â  Â  Â  Â  Â  // Check button's current text to decide action
	Â  Â  Â  Â  Â  Â  Â  Â  if (button.textContent === "é–‹å•ŸASMæª”æ¡ˆ (é ˆç­‰å¤–éƒ¨è…³æœ¬åŸ·è¡Œå®Œç•¢!)") {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const modelName = button.dataset.modelName; // Retrieve stored modelName
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!modelName) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("ç„¡æ³•ç²å–æ¨¡å‹åç¨±ä»¥é–‹å•ŸASM", "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.disabled = false; // Re-enable button
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.disabled = true;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage(`æº–å‚™é–‹å•Ÿ '0-${modelName}.asm'...`, "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const openResult = await CreoJS.runOpenAsmMacro(modelName);
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (openResult === true) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage(`å·²åŸ·è¡Œé–‹å•Ÿ '0-${modelName}.asm' çš„æŒ‡ä»¤ã€‚`, "success");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage(`é–‹å•ŸASMæª”æ¡ˆæ™‚ç™¼ç”ŸéŒ¯èª¤: ${openResult.error || 'æœªçŸ¥éŒ¯èª¤'}`, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("åŸ·è¡Œé–‹å•ŸASMæ“ä½œæ™‚ç™¼ç”Ÿä¾‹å¤–: " + error.message, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } finally {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â button.disabled = false; // Re-enable button after attempt
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	
	Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Original workflow
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.disabled = true;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("é–‹å§‹åŸ·è¡Œæ“ä½œ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // æ¸…ç©ºå…ˆå‰çš„ç‹€æ…‹è¨Šæ¯
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const statusDiv = document.getElementById('status');
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  while (statusDiv.children.length > 1) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusDiv.removeChild(statusDiv.lastChild);
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (statusDiv.children.length === 1 && statusDiv.firstElementChild.textContent !== "æº–å‚™å°±ç·’ï¼Œè«‹é¸æ“‡æ“ä½œã€‚") {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusDiv.firstElementChild.textContent = "æº–å‚™å°±ç·’ï¼Œè«‹é¸æ“‡æ“ä½œã€‚"; // Reset first message if it's not the default
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (statusDiv.children.length === 0) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æº–å‚™å°±ç·’ï¼Œè«‹é¸æ“‡æ“ä½œã€‚", "info"); // Re-add initial message if cleared
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("é–‹å§‹åŸ·è¡Œä¸»è¦æ“ä½œæµç¨‹...", "info");
	
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ç¬¬é›¶æ­¥ï¼šç²å–æ¨¡å‹åç¨±å’Œç•¶å‰ç›®éŒ„ (ç§»åˆ°åŸ·è¡Œåˆªé™¤å’Œè‘—è‰²ä¹‹å‰ï¼Œå› ç‚ºå®ƒå€‘å¯èƒ½éœ€è¦æ¨¡å‹åç¨±)
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStepIndicator("æ­¥é©Ÿ 0ï¼šç²å–æ¨¡å‹è³‡è¨Š");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const modelName = await CreoJS.getCurrentModelName();
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!modelName) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("ç„¡æ³•ç²å–ç•¶å‰æ¨¡å‹åç¨±", "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error("ç„¡æ³•ç²å–ç•¶å‰æ¨¡å‹åç¨±");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.dataset.modelName = modelName; // Store modelName for later use
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("ä½¿ç”¨ç•¶å‰æ¨¡å‹åç¨±: " + modelName, "success");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const originalDir = await CreoJS.getCurrentDirectory();
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("ç•¶å‰å·¥ä½œç›®éŒ„: " + originalDir, "info");
	
	
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ç¬¬ä¸€æ­¥ï¼šåŸ·è¡Œåˆªé™¤æ“ä½œ (å¦‚æœå‹¾é¸)
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (runDelMacroCheckbox.checked) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStepIndicator("æ­¥é©Ÿ 1ï¼šåŸ·è¡Œåˆªé™¤æ“ä½œ");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ­£åœ¨åŸ·è¡Œåˆªé™¤æ“ä½œ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const delResult = await CreoJS.runDelMacro();
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (delResult !== true) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage(`åˆªé™¤æ“ä½œå¤±æ•—: ${delResult.error || 'æœªçŸ¥éŒ¯èª¤'}`, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error("åˆªé™¤æ“ä½œå¤±æ•—");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("åˆªé™¤æ“ä½œå·²å•Ÿå‹•ï¼Œç­‰å¾…å®Œæˆ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let delCompleted = false;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let delAttempts = 0;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const maxDelAttempts = 10;Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  while (!delCompleted && delAttempts < maxDelAttempts) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await new Promise(resolve => setTimeout(resolve, 500));Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  delCompleted = await CreoJS.checkColoringStatus(); // Using checkColoringStatus as a proxy
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  delAttempts++;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (delAttempts === 4) {Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  delCompleted = true;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (delCompleted) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("åˆªé™¤æ“ä½œå®Œæˆ", "success");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("åˆªé™¤æ“ä½œå¯èƒ½æœªå®Œæˆæˆ–æª¢æŸ¥è¶…æ™‚ï¼Œä½†ç¹¼çºŒåŸ·è¡Œä¸‹ä¸€æ­¥", "warning");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("è·³éåˆªé™¤æ“ä½œ (æœªå‹¾é¸)", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
						
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ç¬¬äºŒæ­¥ï¼šåŸ·è¡Œè‘—è‰²æ“ä½œ (å¦‚æœå‹¾é¸)
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (runColorMacroCheckbox.checked) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStepIndicator("æ­¥é©Ÿ 2ï¼šåŸ·è¡Œè‘—è‰²æ“ä½œ");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ­£åœ¨åŸ·è¡Œè‘—è‰²æ“ä½œ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const colorResult = await CreoJS.runColorMacro();
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (colorResult !== true) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage(`è‘—è‰²æ“ä½œå¤±æ•—: ${colorResult.error || 'æœªçŸ¥éŒ¯èª¤'}`, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error("è‘—è‰²æ“ä½œå¤±æ•—");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("è‘—è‰²æ“ä½œå·²å•Ÿå‹•ï¼Œç­‰å¾…å®Œæˆ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let coloringCompleted = false;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let coloringAttempts = 0;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const maxColoringAttempts = 10;Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  while (!coloringCompleted && coloringAttempts < maxColoringAttempts) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await new Promise(resolve => setTimeout(resolve, 500));Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  coloringCompleted = await CreoJS.checkColoringStatus();
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  coloringAttempts++;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (coloringAttempts === 4) {Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  coloringCompleted = true;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (coloringCompleted) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("è‘—è‰²æ“ä½œå®Œæˆï¼Œå·²è¨­ç‚ºé‡‘å±¬è—è‰²", "success");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("è‘—è‰²æ“ä½œå¯èƒ½æœªå®Œæˆæˆ–æª¢æŸ¥è¶…æ™‚ï¼Œä½†ç¹¼çºŒåŸ·è¡Œä¸‹ä¸€æ­¥", "warning");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("è·³éè‘—è‰²æ“ä½œ (æœªå‹¾é¸)", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ç¬¬ä¸‰æ­¥ï¼šåŸ·è¡Œå‚™ä»½æ“ä½œ
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStepIndicator("æ­¥é©Ÿ 3ï¼šåŸ·è¡Œå‚™ä»½æ“ä½œ");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ­£åœ¨åŸ·è¡Œå‚™ä»½æ“ä½œ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const backupResult = await CreoJS.runBackupMacro(modelName);
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (typeof backupResult !== 'string') {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage(`å‚™ä»½æ“ä½œå¤±æ•—: ${backupResult.error || 'æœªçŸ¥éŒ¯èª¤'}`, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error("å‚™ä»½æ“ä½œå¤±æ•—");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("å‚™ä»½æ“ä½œå·²å•Ÿå‹•ï¼Œç­‰å¾…å®Œæˆ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let backupCompleted = false;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let backupAttempts = 0;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const maxBackupAttempts = 8;Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  while (!backupCompleted && backupAttempts < maxBackupAttempts) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await new Promise(resolve => setTimeout(resolve, 500));Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backupCompleted = await CreoJS.checkBackupStatus(modelName);
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backupAttempts++;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (backupAttempts === 4) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backupCompleted = true;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (backupCompleted) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("å‚™ä»½æ“ä½œå®Œæˆï¼Œå·²å‰µå»ºè³‡æ–™å¤¾: " + backupResult, "success");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("å‚™ä»½æ“ä½œå¯èƒ½æœªå®Œæˆæˆ–æª¢æŸ¥è¶…æ™‚ï¼Œä½†ç¹¼çºŒåŸ·è¡Œä¸‹ä¸€æ­¥", "warning");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ç¬¬å››æ­¥ï¼šæ‰¾åˆ°ç›®æ¨™å·¥ä½œè³‡æ–™å¤¾è·¯å¾‘ (æ³¨æ„ï¼šæ­¤è™•åŸæ–‡ç‚ºç¬¬äº”æ­¥ï¼Œä½†é‚è¼¯ä¸Šæ‡‰åœ¨è¨­ç½®å·¥ä½œç›®éŒ„ä¹‹å‰)
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStepIndicator("æ­¥é©Ÿ 4ï¼šå®šä½ç›®æ¨™å·¥ä½œè³‡æ–™å¤¾");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const targetWorkingDir = await CreoJS.findBackupDirectory();Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (targetWorkingDir) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ‰¾åˆ°ç›®æ¨™å·¥ä½œè³‡æ–™å¤¾è·¯å¾‘: " + targetWorkingDir, "success");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ç¬¬äº”æ­¥ï¼šè¨­ç½®å·¥ä½œç›®éŒ„
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStepIndicator("æ­¥é©Ÿ 5ï¼šè¨­ç½®å·¥ä½œç›®éŒ„");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("å˜—è©¦è¨­ç½®å·¥ä½œç›®éŒ„ç‚º: " + targetWorkingDir, "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dirResult = await CreoJS.setWorkingDirectory(targetWorkingDir);
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dirResult && dirResult.error) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("è¨­ç½®å·¥ä½œç›®éŒ„å¤±æ•—: " + dirResult.error, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("å·²æˆåŠŸè¨­ç½®å·¥ä½œç›®éŒ„ç‚º: " + dirResult, "success");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateDirectoryInfo(); // Update display
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("ç„¡æ³•æ‰¾åˆ°ç›®æ¨™å·¥ä½œè³‡æ–™å¤¾è·¯å¾‘ï¼Œè·³éè¨­ç½®å·¥ä½œç›®éŒ„", "warning");
						}
						
						// ç¬¬å…­æ­¥ï¼šé—œé–‰è¦–çª—+æ¸…ç©ºè¨˜æ†¶é«”+åŸ·è¡Œæ›¿æ›æ‰¹æ¬¡æª”
						addStepIndicator("æ­¥é©Ÿ 6ï¼šåŸ·è¡Œæ¸…ç†èˆ‡å¤–éƒ¨EMPæ›¿æ›æ“ä½œ");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ­£åœ¨åŸ·è¡Œæ¸…ç†æ“ä½œ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await new Promise(resolve => setTimeout(resolve, 500));Â 
						
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const cleanResult = await CreoJS.runCleanMacro();
						
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (cleanResult !== true) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage(`æ¸…é™¤æ“ä½œå•Ÿå‹•å¤±æ•—: ${cleanResult.error || 'æœªçŸ¥éŒ¯èª¤'}`, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ¸…é™¤æ“ä½œå·²å•Ÿå‹•ï¼Œç­‰å¾…å®Œæˆ...", "info");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let cleanCompleted = false;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let cleanAttempts = 0;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const maxCleanAttempts = 4;Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  while (!cleanCompleted && cleanAttempts < maxCleanAttempts) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await new Promise(resolve => setTimeout(resolve, 500));Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cleanCompleted = await CreoJS.checkCleanStatus();
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cleanAttempts++;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (cleanAttempts === 2) {Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cleanCompleted = true;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (cleanCompleted) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ¸…é™¤æ“ä½œå®Œæˆ", "success");		
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ¸…é™¤æ“ä½œå¯èƒ½æœªå®Œæˆæˆ–æª¢æŸ¥è¶…æ™‚", "warning");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ­£åœ¨å•Ÿå‹•å¤–éƒ¨EMPæ›¿æ›è…³æœ¬ (000-EMP_Translator_v6.ps1)...", "info");
						const batchResult = await CreoJS.runBatchMacro();	
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("å¤–éƒ¨EMPæ›¿æ›è…³æœ¬å·²å•Ÿå‹•ã€‚", "info");				
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â if (cleanResult !== true) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage(`è…³æœ¬æ“ä½œå•Ÿå‹•å¤±æ•—: ${batchResult.error || 'æœªçŸ¥éŒ¯èª¤'}`, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
							// å®Œæˆæ‰€æœ‰ä¸»è¦æ“ä½œ
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStepIndicator("ä¸»è¦æ“ä½œæµç¨‹å®Œæˆ");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("æ‰€æœ‰ä¸»è¦æ“ä½œå·²å®Œæˆã€‚è«‹ç­‰å¾…å¤–éƒ¨è…³æœ¬ (000-EMP_Translator_v6.ps1) åŸ·è¡Œå®Œç•¢ã€‚", "success");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("å¾…å¤–éƒ¨è…³æœ¬å®Œæˆå¾Œï¼Œé»æ“Šä¸‹æ–¹æŒ‰éˆ•ä»¥é–‹å•Ÿå°æ‡‰çš„ ASM æª”æ¡ˆã€‚", "warning");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.textContent = "é–‹å•ŸASMæª”æ¡ˆ (é ˆç­‰å¤–éƒ¨è…³æœ¬åŸ·è¡Œå®Œç•¢!)"; // Change button text												
						}
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
	
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("åŸ·è¡Œéç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤: " + error.message, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // åœ¨é€™è£¡é‡ç½®æŒ‰éˆ•æ–‡å­—ç‚ºåˆå§‹ç‹€æ…‹ï¼Œè€Œä¸æ˜¯æœå°‹ã€è‘—è‰²ç­‰é•·å¥
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.textContent = "åŸ·è¡Œæ¨¡å‹å‚™ä»½+æ›¿æ›EMP";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } finally {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  button.disabled = false; // Re-enable button
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  });
	
			// æ·»åŠ æ­¥é©ŸæŒ‡ç¤ºå™¨
	Â  Â  Â  Â  Â  Â  function addStepIndicator(stepText) {
	Â  Â  Â  Â  Â  Â  Â  Â  const statusDiv = document.getElementById('status');
	Â  Â  Â  Â  Â  Â  Â  Â  const stepDiv = document.createElement('div');
	Â  Â  Â  Â  Â  Â  Â  Â  stepDiv.className = 'step-indicator';
	Â  Â  Â  Â  Â  Â  Â  Â  stepDiv.textContent = stepText;
	Â  Â  Â  Â  Â  Â  Â  Â  statusDiv.appendChild(stepDiv);
	Â  Â  Â  Â  Â  Â  Â  Â  statusDiv.scrollTop = statusDiv.scrollHeight;
	Â  Â  Â  Â  Â  Â  }
	});
	
	// è¼”åŠ©å‡½æ•¸
	function addStatusMessage(message, type = "info", targetId = "status") {
		const statusDiv = document.getElementById(targetId);
		const messageDiv = document.createElement('div');
		messageDiv.className = 'status-message ' + type;
		messageDiv.textContent = new Date().toLocaleTimeString() + ' - ' + message;
		statusDiv.appendChild(messageDiv);
		statusDiv.scrollTop = statusDiv.scrollHeight;
	}
	
	function sleep(ms) {
		return new Promise(resolve => setTimeout(resolve, ms));
	}
	
	async function updateCurrentModelInfo() {
	Â  Â  Â  Â  Â  Â  CreoJS.getCurrentModelName()
	Â  Â  Â  Â  Â  Â  Â  Â  .then(function(modelName) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const infoDiv = document.getElementById('currentModelInfo');
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (modelName) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  infoDiv.innerHTML = "<strong>ç•¶å‰æ¨¡å‹:</strong> " + modelName;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  infoDiv.innerHTML = "<strong>è­¦å‘Š:</strong> ç„¡æ³•ç²å–ç•¶å‰æ¨¡å‹åç¨± (å¯èƒ½æœªé–‹å•Ÿä»»ä½•æ¨¡å‹)";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  infoDiv.style.backgroundColor = "#fff3cd";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  infoDiv.style.borderLeft = "4px solid #ffc107";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  })
	Â  Â  Â  Â  Â  Â  Â  Â  .catch(function(error) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const infoDiv = document.getElementById('currentModelInfo');
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  infoDiv.innerHTML = "<strong>éŒ¯èª¤:</strong> ç²å–æ¨¡å‹åç¨±æ™‚ç™¼ç”ŸéŒ¯èª¤";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  infoDiv.style.backgroundColor = "#f8d7da";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  infoDiv.style.borderLeft = "4px solid #dc3545";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("ç²å–æ¨¡å‹åç¨±æ™‚ç™¼ç”ŸéŒ¯èª¤: " + error, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  });
	Â  Â  Â  Â  }
	
	async function updateDirectoryInfo() {
	Â  Â  Â  Â  Â  Â  CreoJS.getCurrentDirectory()
	Â  Â  Â  Â  Â  Â  Â  Â  .then(function(dirPath) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dirDiv = document.getElementById('directoryInfo');
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dirPath) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dirDiv.innerHTML = "<strong>ç•¶å‰å·¥ä½œç›®éŒ„:</strong> " + dirPath;
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dirDiv.innerHTML = "<strong>è­¦å‘Š:</strong> ç„¡æ³•ç²å–ç•¶å‰å·¥ä½œç›®éŒ„";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dirDiv.style.backgroundColor = "#fff3cd";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dirDiv.style.borderLeft = "4px solid #ffc107";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  Â  Â  Â  })
	Â  Â  Â  Â  Â  Â  Â  Â  .catch(function(error) {
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dirDiv = document.getElementById('directoryInfo');
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dirDiv.innerHTML = "<strong>éŒ¯èª¤:</strong> ç²å–å·¥ä½œç›®éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dirDiv.style.backgroundColor = "#f8d7da";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dirDiv.style.borderLeft = "4px solid #dc3545";
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
	Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addStatusMessage("ç²å–å·¥ä½œç›®éŒ„æ™‚ç™¼ç”ŸéŒ¯èª¤: " + error, "error");
	Â  Â  Â  Â  Â  Â  Â  Â  });
	Â  Â  Â  Â  }
	
	// å®šæœŸæ›´æ–°æ¨¡å‹å’Œç›®éŒ„è³‡è¨Š
	setInterval(updateCurrentModelInfo, 5000);
	setInterval(updateDirectoryInfo, 10000);
</script>
</body>
</html>
